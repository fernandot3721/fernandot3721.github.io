<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>web ar测试</title>
<script>
function init()
{
    const EVENT_DETECTOR_INIT_RESULT = "DetectorInitResult";
    const EVENT_DETECT_RESULT = "DetectorResult";

    var arSession = ucweb.ARSession;
    
    arSession.addEventListener(EVENT_DETECTOR_INIT_RESULT, function (code){ // ?
        let ir = document.getElementById('ir')
        ir.innerHTML="init result is: " + code;
        console.log('init resutl is: ' + code);
    });
    arSession.addEventListener(EVENT_DETECT_RESULT, function (result){ // ?
        let dr = document.getElementById('dr')
        dr.innerHTML="detect result is: " + result;
        console.log('detect result is: ' + result);
    });

    let selectDetector = function() {
        let detector = arSession.setDetector("ExampleDetector");
        detector.setMarkers(['deault']); // hardcode
    }

    let startSuccess = function() {
        console.log('camera success');
        setTimeout(selectDetector, 1000);
    };

    let startError = function(e) {
        console.log('camera error: ' + e);
    };

    MediaStreamTrack.getSources(function(deviceInfos) {
        let constraints;
        let flag = false;

        for (let i = 0; i !== deviceInfos.length; ++i) {
            let deviceInfo = deviceInfos[i];
            if (deviceInfo.kind === 'video' && deviceInfo.facing === 'environment') {
                constraints = { video: { mandatory: {sourceId: deviceInfo.id} } };
                flag = true;
            }
        }
        if (!flag) {
            constraints = { video: true };
        }
        arSession.start(constraints, startSuccess, startError);
    });
}
</script>

<style>
*{
padding: 0;
margin: 0;
}
body{
padding: 50px;
/*background: url(bg.png) 0 0 repeat;*/
background-color: transparent;
    color:green;
}
h1 {
    color:green;
}
</style>
</head>
<body>    

<h1 onclick="init()">init</h1>
<br/>

<h1 id="ir">initResult</h1>
<br/>

<h1 id="dr">detectResult</h1>
<br/>

</body>    
</html>
